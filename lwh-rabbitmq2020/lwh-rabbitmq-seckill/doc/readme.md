# 商城秒杀系统设计与实战

1、订单编号的生成方式
```lua
1.采用传统的时间戳+n为流水号（UUID也是一个道理）构成
2.雪花算法：高效率生成分布式唯一ID的最佳方式 https://github.com/souyunku/SnowFlake

比较：
①传统的方式要么太长，没法排序，要么需要依赖中间件
②雪花算法（整体上安排时间自增排序，并且整个分布式系统内不会产生ID碰撞，高效率）
```

2、死信队列失效超时未支付的订单
```lua
1.RabbitMQ死信队列缺陷：有许多订单在某个TTL集中失效，但是恰好RabbitMQ服务挂掉了
2.补充解决方案：
  基于@Scheduled注解的定时任务实现
  批量获取status=0的订单并判断时间超过了TTL
3.解决方案：
  结合线程池一起使用，规避单一线程处理多个任务调度的缺陷，支持多线程处理
```
